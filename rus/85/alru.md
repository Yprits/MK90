# Алгоритмы МК-85
## Функция RAN# (подпрограмма ПЗУ 2FC6)
Калькулятор фактически генерирует псевдослучайные целые числа в диапазоне 0-32767. Результат домножается на 0,30517578125E-4 (= 1/32768), чтобы получить действительное число в диапазоне 0-0,9999...

Приведенная ниже программа BASIC вычисляет псевдослучайные 15-разрядные целые числа, используя тот же алгоритм, что и функция **RAN#**. Для сравнения она также печатает значения, возвращаемые реальной функцией **RAN#**.
```
10 S=32768*RAN#
20 S=12869*S+6925
30 S=S-32768*INT(S/32768)
40 PRINT S;32768*RAN#
50 GOTO 20
```
## Функция root (подпрограмма ПЗУ 300E)
Показанная ниже BASIC-программа иллюстрирует алгоритм, используемый MK-85. Она вычисляет квадратные корни чисел в диапазоне от 1 до 99,9999... с точностью R цифр.

Оригинальная процедура использует только простые и эффективные математические операции: сдвиг, сложение/вычитание, сравнение и просмотр таблицы. BASIC-версия должна была имитировать сдвиги двоично-десятичных чисел с умножением на степени 10.

Подробное описание алгоритма этой и следующих функций можно найти в статье [JE Meggitt, Pseudo Division and Pseudo Multiplication Processes, IBM Journal, Res & Dev, April 1962](https://github.com/Yprits/MK90/files/8507609/meggitt.pdf).
```
5 R=7
10 INPUT "Radicand=",A
20 IF A<1 THEN 40
30 IF A<100 THEN 50
40 PRINT "Invalid!":GOTO 10
50 B=1:Q=0:J=0

200 IF J>=R THEN 600
210 IF A<B THEN 400

300 A=A-B
310 GOSUB 800
320 B=B+2*D
330 Q=Q+1
340 GOTO 200

400 A=10*A
410 B=B-D
420 Q=10*Q
430 J=J+1
440 GOSUB 800
450 B=B+D
460 GOTO 200

600 PRINT "SQR=";Q/10^R
610 GOTO 10

800 D=10^-J
810 RETURN
```

## Функция EXP (подпрограмма ПЗУ 30A2)
Следующая BASIC-программа вычисляет EXP(x) для чисел в диапазоне от 0 до LN(10) с точностью до R цифр. Она использует тот же алгоритм, что и исходный код в ПЗУ MK-85.
```
10 R=7: ЕСЛИ R>6; DEFM(R-1) 
20 FOR J=0 TO R-1 
30 T(J)=LN(1+10^-J)*10^J 
40 NEXT J 

100 INPUT "Argument=",A 
110 IF A<0 THEN 130 
120 IF A<LN(10) THEN 140 
130 PRINT "Invalid!":GOTO 100 
140 Q=0:J=0 
150 GOTO 500 

200 IF J>=R THEN 600 
210 IF A<B THEN 400 

300 A= AB 
310 Q=Q+1 
320 ПЕРЕЙТИ к 200 

400 A=A*10 
410 Q=Q*10 
420 J=J+1 

500 B=T(J) 
510 ПЕРЕЙТИ к 200 

600 A=0:B=10^R 

700 ЕСЛИ FRAC(Q/10)<>0 THEN 800 
710 IF Q<>0 THEN 900 
720 GOTO 1000 

800 M=INT(B/10^J) 
810 A=A+B 
820 B=B+M 
830 Q=Q- 1 
840 ПЕРЕЙТИ К 700

900 A=INT(A/10) 
910 Q=INT(Q/10) 
920 J=J-1 
930 GOTO 700 

1000 PRINT "EXP=";1+A/10^(R+J) 
1010 GOTO 100
```

## Натуральный логарифм (подпрограмма ПЗУ 31AC)
Следующая BASIC-программа вычисляет LN(x) для чисел в диапазоне от 1 до 10 с точностью до R цифр. Она использует тот же алгоритм, что и исходный код в ПЗУ MK-85.

```
10 R=7: ЕСЛИ R>6; DEFM(R-1) 
20 FOR J=0 TO R-1 
30 T(J)=LN(1+10^-J)*10^J 
40 NEXT J 

100 INPUT "Argument=",A 
110 IF A<1 THEN 130 
120 IF A<10 THEN 140 
130 PRINT "Invalid!":GOTO 100 
140 Q=0:B=1:J=0 
150 A=A-1 

200 IF J>=R THEN 500 
210 IF A<B THEN 400 

300 M=B*10^-J 
310 A=AB 
320 B=B+M 
330 Q=Q+1 
340 ПЕРЕЙТИ 200 

400 A=A*10 
410 Q=Q*10 
420 J=J+1 
430 ПЕРЕЙТИ 200 

500 A=0 
510 ПЕРЕЙТИ К 900 

600 ЕСЛИ 10*FRAC(Q/10)<>0 ТО 700 
610 ЕСЛИ Q<>0 ТО 800 
620 ПЕРЕЙТИ К 1000 

700 A=A+B 
710 Q=Q-1 
720 ПЕРЕЙТИ К 600

800 A=INT(A/10) 
810 Q=INT(Q/10) 
820 J=J-1 

900 B=T(J) 
910 GOTO 600 

1000 PRINT "LN=";A*10^-J 
1010 GOTO 100
```

## Касательная дуги (подпрограмма ПЗУ 33E4)
Следующая BASIC-программа вычисляет ATN(x) для аргументов в диапазоне от 0 до 1 с точностью до R цифр. Она использует тот же алгоритм, что и исходный код в ПЗУ MK-85.
```
10 R=7: ЕСЛИ R>6; DEFM(R-1) 
20 FOR J=0 TO R-1 
30 T(J)=ATN(10^-J)*10^J 
40 NEXT J 

100 INPUT "Argument=",A 
110 IF A<0 THEN 130 
120 IF A<1 THEN 140 
130 PRINT "Invalid!":GOTO 100 
140 Q=0:B=1:J=0 

200 IF J>=R THEN 500 
210 IF A<B THEN 400 

300 M=A*10^ (-2*J) 
310 A=AB 
320 B=B+M 
330 Q=Q+1 
340 GOTO 200 

400 A=A*10 
410 Q=Q*10 
420 J=J+1 
430 GOTO 200 

500 A=0 
510 ПЕРЕЙТИ К 900 

600 ЕСЛИ 10*FRAC(Q/10)<>0 ТО 700 
610 ЕСЛИ Q<>0 ТО 800 
620 ПЕРЕЙТИ К 1000 

700 A=A+B 
710 Q=Q-1 
720 ПЕРЕЙТИ К 600 

800 A=INT(A /10)
810 Q=INT(Q/10) 
820 J=J-1 

900 B=T(J) 
910 GOTO 600 

1000 PRINT "ATN=";A*10^-J 
1010 GOTO 100
```

## Тангенс (подпрограмма ПЗУ 362C)
Следующая BASIC-программа вычисляет TAN(x) для аргументов в диапазоне от 0 до PI/2 радиан с точностью до R цифр. Она использует тот же алгоритм, что и исходный код в ПЗУ MK-85.
```
10 РЕЖИМ 5:R=7:ЕСЛИ R>6; DEFM(R-1) 
20 FOR J=0 TO R-1 
30 T(J)=ATN(10^-J)*10^J 
40 NEXT J 

100 INPUT "Argument=",A 
110 IF A<0 THEN 130 
120 IF A<PI/2 THEN 140 
130 PRINT "Invalid!":GOTO 100 
140 Q=0:J=0 
150 GOTO 500 

200 IF J>=R THEN 600 
210 IF A<B THEN 400 

300 A=AB 
310 Q =Q+1 
320 ПЕРЕЙТИ К 200 

400 A=A*10 
410 Q=Q*10 
420 J=J+1 

500 B=T(J) 
510 ПЕРЕЙТИ к 200 

600 A=0:B=10^R 

700 IF 10*FRAC (Q/10)<>0 THEN 800 
710 IF Q<>0 THEN 900 
720 GOTO 1000 

800 M=INT(A*10^(-2*J)) 
810 A=A+B 
820 B=BM 
830 Q= В-1
840 GOTO 700 

900 A=INT(A/10) 
910 Q=INT(Q/10) 
920 J=J-1 
930 GOTO 700 

1000 PRINT "TAN=";A/B/10^J 
1010 GOTO 100
```
